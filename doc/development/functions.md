How to add a new function
===

What you should take into account
---

1. Each function (that behaves differently) must be in a separate file
2. Functions should be stored in `expr/functions/$function_name` directory.
3. Function type should be called exactly the same as package
4. Function type must implement `interfaces.Function`. There is helper `interfaces.FunctionBase` that implements basic `SetEvaluator` and `GetEvaluator` functions
5. There is a way to auto-generate `Description` method from graphite-web's output: `scripts/json_to_go_struct.sh`. Script is very hackish, but works most of the time.
6. Each function must have valid description, type, name, etc. Ideally description should contain examples, but that's not a strict requirement
7. All functions and it's aliases must be registered in `func init()`.
8. To create new `expr/functions/glue.go` you can do `cd expr/functions/; go generate > glue.go.new; mv glue.go.new glue.go`. This will automatically add all necessary imports.

How functions works
===

`expr/metadata`
---
Contains all metadata as a static global variables.

`func RegisterFunction(name string, function interfaces.Function)` - registers function in metadata

`FunctionMD` - contains metadata about all known functions

`FunctionDescriptions map[string]*types.FunctionDescription` - contains descriptions of all known functions

`FunctionDescriptionsGrouped map[string]map[string]*types.FunctionDescription` - contains descriptions of all known functions, grouped by function group

`expr/expr.go`
---

Contains `EvalExpr` - main expression parser, plus `RewriteExpr` - rewrite phase of expression parsing.

`EvalExpr` always uses `metadata.FunctionMD` to get list of known functions.

Functions registered by importing `expr/functions/glue.go`

`expr/functions/glue.go`
---

Autogenerated by `expr/functions/gen.go`. Only imports all functions and allows their `func init()` to register them in metadata